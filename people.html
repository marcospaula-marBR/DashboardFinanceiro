<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PeopleBoard | CSI MAR BRASIL</title>

    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="people.css?v=27.10">
</head>

<body>

    <div class="hud-container">

        <header class="hud-header">
            <div class="brand">
                <img src="Mar-Brasil-sem-fundo-preto.png" alt="Logo" style="max-height: 60px;">
                <h1 class="hud-title mt-2">PEOPLE BOARD <span style="font-size: 0.5em; opacity: 0.5;">v1.0</span></h1>
            </div>
            <div class="hud-controls d-flex gap-3">
                <button class="btn btn-outline-warning" id="btnAddEmployee">
                    <i class="bi bi-person-plus-fill me-2"></i>NOVO REGISTRO
                </button>
                <a href="landing.html" class="btn btn-outline-secondary">
                    <i class="bi bi-house-door me-2"></i>VOLTAR
                </a>
            </div>
        </header>

        <!-- Filtros HUD -->
        <section class="hud-panel p-4 mb-4">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="label d-block mb-1">LOCALIZAR</label>
                    <input type="text" id="filterName"
                        class="form-control form-control-sm bg-dark text-white border-secondary"
                        placeholder="Nome ou CPF/CNPJ...">
                </div>
                <div class="col-md-2">
                    <label class="label d-block mb-1">EMPRESA</label>
                    <select id="filterCompany" class="form-select form-select-sm bg-dark text-white border-secondary">
                        <option value="">TODAS</option>
                        <option value="MarBR">MarBR</option>
                        <option value="DZM">DZM</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="label d-block mb-1">VÍNCULO</label>
                    <select id="filterType" class="form-select form-select-sm bg-dark text-white border-secondary">
                        <option value="">TODOS</option>
                        <option value="CLT">CLT</option>
                        <option value="Estagiário">Estagiário</option>
                        <option value="PJ">PJ</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="label d-block mb-1">SETOR</label>
                    <select id="filterDept" class="form-select form-select-sm bg-dark text-white border-secondary">
                        <option value="">TODOS</option>
                    </select>
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <div id="brisinhai-mini" class="hud-panel"
                        style="margin-bottom:0; flex-grow:1; padding:10px; font-size: 0.75rem; border-color: var(--secondary);">
                        <i class="bi bi-robot me-2"></i>Aguardando análise de dados...
                    </div>
                </div>
            </div>
        </section>

        <!-- Listagem Table HUD -->
        <section class="hud-panel">
            <h3 class="label mb-3" style="color: var(--primary);">DATABASE :: REGISTROS ATIVOS</h3>
            <div class="table-responsive">
                <table class="people-table">
                    <thead>
                        <tr>
                            <th>NOME</th>
                            <th>EMPRESA</th>
                            <th>VÍNCULO</th>
                            <th>SETOR / FUNÇÃO</th>
                            <th>REDAÇÃO FINAL (VALOR)</th>
                            <th>STATUS</th>
                        </tr>
                    </thead>
                    <tbody id="employeesList">
                        <!-- Carregado via JS -->
                    </tbody>
                </table>
            </div>
        </section>

    </div>

    <!-- Overlay de Detalhes (Estilo CSI) -->
    <div id="profileOverlay">
        <div class="hud-profile">
            <button class="btn-close-hud" onclick="closeProfile()">X FECHAR</button>
            <div class="profile-left">
                <div class="profile-photo-container">
                    <img id="profilePhoto" src="https://via.placeholder.com/350" alt="Photo" class="profile-photo">
                    <div class="photo-scanline"></div>
                </div>
                <div class="mt-4 hud-panel" style="border-color: var(--secondary);">
                    <h4 class="label mb-2" style="color: var(--secondary);">IDENTIFICAÇÃO BIOMÉTRICA</h4>
                    <p class="small text-muted mb-1">ID ÚNICO: <span id="profileID" class="value">...</span></p>
                    <p class="small text-muted">DATA CRIAÇÃO: <span id="profileCreated" class="value">...</span></p>
                </div>
            </div>
            <div class="profile-right">
                <h2 id="profileName" class="hud-font mb-4" style="color: var(--primary);">NOME COMPLETO</h2>

                <div class="row">
                    <div class="col-md-6">
                        <div class="data-row"><span class="label">EMPRESA</span><span id="profileCompany"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">VÍNCULO</span><span id="profileType"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">DOCUMENTO</span><span id="profileDoc"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">SETOR</span><span id="profileDept"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">FUNÇÃO</span><span id="profileRole"
                                class="value">...</span></div>
                    </div>
                    <div class="col-md-6">
                        <div class="data-row"><span class="label">ADMISSÃO</span><span id="profileStart"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">REMUNERAÇÃO</span><span id="profileRemuneration"
                                class="value" style="color: #2ecc71;">...</span></div>
                        <div class="data-row"><span class="label">CHAVE PIX</span><span id="profilePix"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">RESPONSÁVEL</span><span id="profileResp"
                                class="value">...</span></div>
                        <div class="data-row"><span class="label">SITUAÇÃO</span><span id="profileStatus"
                                class="value">...</span></div>
                    </div>
                </div>

                <div class="mt-4">
                    <h4 class="label mb-3" style="color: var(--secondary);">ADITIVOS E HISTÓRICO</h4>
                    <div id="profileHistory" class="small" style="max-height: 200px; overflow-y: auto;">
                        <!-- Histórico carregado aqui -->
                    </div>
                </div>

                <div class="mt-auto pt-4 d-flex gap-3">
                    <button class="btn btn-primary btn-sm" onclick="editEmployee()"><i
                            class="bi bi-pencil-square me-2"></i>EDITAR</button>
                    <button class="btn btn-outline-warning btn-sm" onclick="addHistory()"><i
                            class="bi bi-plus-lg me-2"></i>ADICIONAR ADITIVO</button>
                    <button class="btn btn-outline-info btn-sm" id="btnAnalyzePerson"><i
                            class="bi bi-robot me-2"></i>BRISINH ANALYSE</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Inserção/Edição (Formulário HUD) -->
    <div class="modal fade" id="employeeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content bg-dark border-warning" style="border: 1px solid var(--primary);">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title hud-font" id="modalTitle" style="color: var(--primary);">REGISTRAR NOVO
                        OPERAÇÃO</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="employeeForm">
                        <input type="hidden" id="empId">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="label mb-1">CÓDIGO NOMINAL (NOME)</label>
                                <input type="text" id="empName" class="form-control bg-dark text-white border-secondary"
                                    required>
                            </div>
                            <div class="col-md-3">
                                <label class="label mb-1">EMPRESA</label>
                                <select id="empCompany" class="form-select bg-dark text-white border-secondary">
                                    <option value="MarBR">MarBR</option>
                                    <option value="DZM">DZM</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="label mb-1">VÍNCULO</label>
                                <select id="empType" class="form-select bg-dark text-white border-secondary">
                                    <option value="CLT">CLT</option>
                                    <option value="Estagiário">Estagiário</option>
                                    <option value="PJ">PJ</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="label mb-1">DOC (CPF/CNPJ)</label>
                                <input type="text" id="empDoc" class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-4">
                                <label class="label mb-1">CHAVE PIX</label>
                                <input type="text" id="empPix" class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-4">
                                <label class="label mb-1">RED. FINAL (REMUNERAÇÃO)</label>
                                <input type="number" id="empRemuneration"
                                    class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-6">
                                <label class="label mb-1">SETOR</label>
                                <input type="text" id="empDept"
                                    class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-6">
                                <label class="label mb-1">FUNÇÃO</label>
                                <input type="text" id="empRole"
                                    class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-6">
                                <label class="label mb-1">DATA INICIAL</label>
                                <input type="date" id="empStart"
                                    class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-6">
                                <label class="label mb-1">RESPONSÁVEL (PJ)</label>
                                <input type="text" id="empResp"
                                    class="form-control bg-dark text-white border-secondary">
                            </div>
                            <div class="col-md-12">
                                <label class="label mb-1">URL DA FOTO (AVATAR)</label>
                                <input type="text" id="empPhoto"
                                    class="form-control bg-dark text-white border-secondary" placeholder="https://...">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">CANCELAR</button>
                    <button type="button" class="btn btn-warning" onclick="saveEmployee()">CONFIRMAR
                        TRANSMISSÃO</button>
                </div>
            </div>
        </div>
    </div>

    <!-- BrisinhAI Integrado (Modal Analítico) -->
    <div class="modal fade" id="aiModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content bg-dark" style="border: 2px solid var(--secondary);">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title hud-font" style="color: var(--secondary);">BRISINH ANALYTICS :: AI PROTOCOL
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <div id="aiResponse" class="hud-panel p-4"
                        style="min-height: 300px; font-family: monospace; line-height: 1.6;">
                        Iniciando processamento paralelo... <br>Aguardando entrada de dados.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="people.js?v=27.10"></script>
</body>

</html>